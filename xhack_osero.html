<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
  <h1>オセロゲーム -CANVAS-</h1>
  <canvas width="400" height="400" id="canvas" style="background-color: green;"></canvas>
  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext("2d");

    // ctx.fillStyle = "orange";
    // ctx.fillRect(100, 100, 50, 50);

    // fillRectとfor文を使ってたくさんのカラフルな四角形をランダムに描画する
    // function getRandomColor() {
    //   const r = Math.floor(Math.random() * 256);
    //   const b = Math.floor(Math.random() * 256);
    //   const g = Math.floor(Math.random() * 256);
    //   return `rgb(${r}, ${g}, ${b})`;
    // }

    // for(let i = 0; i < 50; i ++) {
    //   const ctx = canvas.getContext("2d");
    //   ctx.fillStyle = getRandomColor();
    // ↓は値に直接Math.floorではなくて一度変数に格納or座標・サイズを定めるメソッドを作ってその値を入れるべき
    //   ctx.fillRect(Math.floor(Math.random() * 400),Math.floor(Math.random() * 400),Math.floor(Math.random() * 100),Math.floor(Math.random() * 100));
    // }

    // パッと見何かわからない数値は分かりやすい名前の定数・変数に格納する
    const FIELDWIDTH = 400;
    const FIELDHEIGHT = 400;
    const BLOCK_SIZE = FIELDWIDTH / 8;
    // オセロの緑の盤面に黒のラインを引いていく
    drawReversiFieldLine();
    function drawReversiFieldLine() {
      // 横線の描画
      for(let i = 1; i < 8; i++){

        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(0, BLOCK_SIZE * i);
        ctx.lineTo(FIELDHEIGHT, BLOCK_SIZE * i);
        ctx.closePath();
        ctx.stroke();
      }

      // 縦線の描画
      for(let i = 1; i < 8; i++){
        ctx.lineWidth = 1;
        ctx.beginPath(); // 経路の開始
        ctx.moveTo(BLOCK_SIZE * i, 0); // 描画開始地点
        ctx.lineTo(BLOCK_SIZE * i, FIELDWIDTH); // 描画終了地点
        ctx.closePath();// 経路の終了
        ctx.stroke();
      }
    }

    // 石を置く処理
    function drawStone(x, y, color) {
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(25 + x * 50, 25 + y * 50, 22, 0, 2 * Math.PI);
      ctx.fill();
    }

    // 初期石の配置
    gameStart();
    function gameStart() {
      drawStone(3, 3, "white");
      drawStone(3, 4, "black");
      drawStone(4, 3, "black");
      drawStone(4, 4, "white");
    }

    // canvas上クリックで石を配置できるようにする

    // ブラウザ全体ではなくcanvas上での位置を取得する
    let currentPlayer = "white";
    canvas.onclick = (e) => {
      var rect = e.target.getBoundingClientRect();
      mouseX = e.clientX - Math.floor(rect.left);
      mouseY = e.clientY - Math.floor(rect.top);

      // drawStone関数に与える位置の数値はクリック位置そのままではなく、drawStone関数のarc()内で行っている計算の逆を行う必要あり
      const posX = Math.round((mouseX -25) / 50);
      const posY = Math.round((mouseY -25) / 50);
      console.log({ posX, posY });
      drawStone(posX, posY, currentPlayer);
      currentPlayer = currentPlayer === "white" ? "black" : "white";
    }
  </script>
</body>
</html>
